// This function calculates edd = Mhat^(-1)*v for a "noodle"
// made up of 3 ANCF identical beam elements.
//
// As such, the input vector 'v' and the output vector 'edd'
// are assumed to be of length (3+1)*6 = 24
//
// Note that the matrix Mhat used for this calculation is just
//    Mhat = \int_0^1 { S^T(\xi) S(\xi) d \xi } 
// As such, the result must be muliplied by 1/(rho * A * lE)
// where lE is element length: lE = L / numElements

#include <stdio.h>
#include "SPHCudaUtils.h"
#include "minv_vec.cuh"

void minv_vec_3(real_ lE, real_* v, real_* edd);
void minv_vec_4(real_ lE, real_* v, real_* edd);
void minv_vec_5(real_ lE, real_* v, real_* edd);
void minv_vec_weld_3(real_ lE, real_* v, real_* edd);
void minv_vec_weld_4(real_ lE, real_* v, real_* edd);
void minv_vec_weld_5(real_ lE, real_* v, real_* edd);

void min_vec(real_* edd, real_* v, real_ lE, int nE, bool isCantilever) {
	if (isCantilever) {
		if (nE == 3) {	minv_vec_weld_3(lE, v, edd);	}
		else if (nE == 4) {	minv_vec_weld_4(lE, v, edd);	}
		else if (nE == 5) {	minv_vec_weld_5(lE, v, edd);	}
		else {	printf("Error!!: Number of beam elements equal to %d is not supported. Code exits!\n;");}
	} else {
		if (nE == 3) {	minv_vec_3(lE, v, edd);	}
		else if (nE == 4) {	minv_vec_4(lE, v, edd);	}
		else if (nE == 5) {	minv_vec_5(lE, v, edd);	}
		else {	printf("Error!!: Number of beam elements equal to %d is not supported. Code exits!\n;");}
	}
}
//******************* Functions Implementations ******************************
void minv_vec_3(real_ lE, real_* v, real_* edd)
{
	real_ v1  = v[0];
	real_ v2  = v[1];
	real_ v3  = v[2];
	real_ v4  = v[3];
	real_ v5  = v[4];
	real_ v6  = v[5];
	real_ v7  = v[6];
	real_ v8  = v[7];
	real_ v9  = v[8];
	real_ v10 = v[9];
	real_ v11 = v[10];
	real_ v12 = v[11];
	real_ v13 = v[12];
	real_ v14 = v[13];
	real_ v15 = v[14];
	real_ v16 = v[15];
	real_ v17 = v[16];
	real_ v18 = v[17];
	real_ v19 = v[18];
	real_ v20 = v[19];
	real_ v21 = v[20];
	real_ v22 = v[21];
	real_ v23 = v[22];
	real_ v24 = v[23];

	real_ t2 = 1.0/lE;
	real_ t3 = 1.0/(lE*lE);

	edd[0]  = v1*1.386048285594416E1+v7*1.128494603150387+v13*2.367748579274572E-1-v19*2.796445325908692E-1-t2*(v4*8.962202982569892E1+v10*1.296235554368969E1+v16*3.980319615545978+v22*3.753766352645028);

	edd[0]  = t2*(v4*5.8745E5+v10*8.4965E4+v16*2.609E4+v22*2.4605E4-lE*v1*9.0852E4-lE*v7*7.397E3-lE*v13*1.552E3+lE*v19*1.833E3)*(-1.525611197986193E-4);
	edd[1]  = t2*(v5*5.8745E5+v11*8.4965E4+v17*2.609E4+v23*2.4605E4-lE*v2*9.0852E4-lE*v8*7.397E3-lE*v14*1.552E3+lE*v20*1.833E3)*(-1.525611197986193E-4);
	edd[2]  = t2*(v6*5.8745E5+v12*8.4965E4+v18*2.609E4+v24*2.4605E4-lE*v3*9.0852E4-lE*v9*7.397E3-lE*v15*1.552E3+lE*v21*1.833E3)*(-1.525611197986193E-4);
	edd[3]  = t3*(v4*1.0071E6+v10*2.19678E5+v16*6.99E4+v22*6.6042E4-lE*v1*1.1749E5-lE*v7*1.7999E4-lE*v13*4.138E3+lE*v19*4.921E3)*7.628055989930966E-4;
	edd[4]  = t3*(v5*1.0071E6+v11*2.19678E5+v17*6.99E4+v23*6.6042E4-lE*v2*1.1749E5-lE*v8*1.7999E4-lE*v14*4.138E3+lE*v20*4.921E3)*7.628055989930966E-4;
	edd[5]  = t3*(v6*1.0071E6+v12*2.19678E5+v18*6.99E4+v24*6.6042E4-lE*v3*1.1749E5-lE*v9*1.7999E4-lE*v15*4.138E3+lE*v21*4.921E3)*7.628055989930966E-4;
	edd[6]  = t2*(v4*-8.9995E4-v10*1.231E4+v16*2.066E4+v22*2.069E4+lE*v1*7.397E3+lE*v7*1.2332E4-lE*v13*1.028E3+lE*v19*1.552E3)*1.525611197986193E-4;
	edd[7]  = t2*(v5*-8.9995E4-v11*1.231E4+v17*2.066E4+v23*2.069E4+lE*v2*7.397E3+lE*v8*1.2332E4-lE*v14*1.028E3+lE*v20*1.552E3)*1.525611197986193E-4;
	edd[8]  = t2*(v6*-8.9995E4-v12*1.231E4+v18*2.066E4+v24*2.069E4+lE*v3*7.397E3+lE*v9*1.2332E4-lE*v15*1.028E3+lE*v21*1.552E3)*1.525611197986193E-4;
	edd[9]  = t3*(v4*2.19678E5+v10*1.5762E5+v16*7.284E4+v22*6.99E4-lE*v1*1.6993E4-lE*v7*2.462E3-lE*v13*4.132E3+lE*v19*5.218E3)*7.628055989930966E-4;
	edd[10] = t3*(v5*2.19678E5+v11*1.5762E5+v17*7.284E4+v23*6.99E4-lE*v2*1.6993E4-lE*v8*2.462E3-lE*v14*4.132E3+lE*v20*5.218E3)*7.628055989930966E-4;
	edd[11] = t3*(v6*2.19678E5+v12*1.5762E5+v18*7.284E4+v24*6.99E4-lE*v3*1.6993E4-lE*v9*2.462E3-lE*v15*4.132E3+lE*v21*5.218E3)*7.628055989930966E-4;
	edd[12] = t2*(v4*-2.069E4-v10*2.066E4+v16*1.231E4+v22*8.9995E4+lE*v1*1.552E3-lE*v7*1.028E3+lE*v13*1.2332E4+lE*v19*7.397E3)*1.525611197986193E-4;
	edd[13] = t2*(v5*-2.069E4-v11*2.066E4+v17*1.231E4+v23*8.9995E4+lE*v2*1.552E3-lE*v8*1.028E3+lE*v14*1.2332E4+lE*v20*7.397E3)*1.525611197986193E-4;
	edd[14] = t2*(v6*-2.069E4-v12*2.066E4+v18*1.231E4+v24*8.9995E4+lE*v3*1.552E3-lE*v9*1.028E3+lE*v15*1.2332E4+lE*v21*7.397E3)*1.525611197986193E-4;
	edd[15] = t3*(v4*6.99E4+v10*7.284E4+v16*1.5762E5+v22*2.19678E5-lE*v1*5.218E3+lE*v7*4.132E3+lE*v13*2.462E3+lE*v19*1.6993E4)*7.628055989930966E-4;
	edd[16] = t3*(v5*6.99E4+v11*7.284E4+v17*1.5762E5+v23*2.19678E5-lE*v2*5.218E3+lE*v8*4.132E3+lE*v14*2.462E3+lE*v20*1.6993E4)*7.628055989930966E-4;
	edd[17] = t3*(v6*6.99E4+v12*7.284E4+v18*1.5762E5+v24*2.19678E5-lE*v3*5.218E3+lE*v9*4.132E3+lE*v15*2.462E3+lE*v21*1.6993E4)*7.628055989930966E-4;
	edd[18] = t2*(v4*2.4605E4+v10*2.609E4+v16*8.4965E4+v22*5.8745E5-lE*v1*1.833E3+lE*v7*1.552E3+lE*v13*7.397E3+lE*v19*9.0852E4)*1.525611197986193E-4;
	edd[19] = t2*(v5*2.4605E4+v11*2.609E4+v17*8.4965E4+v23*5.8745E5-lE*v2*1.833E3+lE*v8*1.552E3+lE*v14*7.397E3+lE*v20*9.0852E4)*1.525611197986193E-4;
	edd[20] = t2*(v6*2.4605E4+v12*2.609E4+v18*8.4965E4+v24*5.8745E5-lE*v3*1.833E3+lE*v9*1.552E3+lE*v15*7.397E3+lE*v21*9.0852E4)*1.525611197986193E-4;
	edd[21] = t3*(v4*6.6042E4+v10*6.99E4+v16*2.19678E5+v22*1.0071E6-lE*v1*4.921E3+lE*v7*4.138E3+lE*v13*1.7999E4+lE*v19*1.1749E5)*7.628055989930966E-4;
	edd[22] = t3*(v5*6.6042E4+v11*6.99E4+v17*2.19678E5+v23*1.0071E6-lE*v2*4.921E3+lE*v8*4.138E3+lE*v14*1.7999E4+lE*v20*1.1749E5)*7.628055989930966E-4;
	edd[23] = t3*(v6*6.6042E4+v12*6.99E4+v18*2.19678E5+v24*1.0071E6-lE*v3*4.921E3+lE*v9*4.138E3+lE*v15*1.7999E4+lE*v21*1.1749E5)*7.628055989930966E-4;
}



// Same as above, but for a "noodle" made up of 4 ANCF beam elements
// In this case, 'v' and 'edd' are of length (4+1)*6 = 30
//
void minv_vec_4(real_ lE, real_* v, real_* edd)
{
	real_ v1  = v[0];
	real_ v2  = v[1];
	real_ v3  = v[2];
	real_ v4  = v[3];
	real_ v5  = v[4];
	real_ v6  = v[5];
	real_ v7  = v[6];
	real_ v8  = v[7];
	real_ v9  = v[8];
	real_ v10 = v[9];
	real_ v11 = v[10];
	real_ v12 = v[11];
	real_ v13 = v[12];
	real_ v14 = v[13];
	real_ v15 = v[14];
	real_ v16 = v[15];
	real_ v17 = v[16];
	real_ v18 = v[17];
	real_ v19 = v[18];
	real_ v20 = v[19];
	real_ v21 = v[20];
	real_ v22 = v[21];
	real_ v23 = v[22];
	real_ v24 = v[23];
	real_ v25 = v[24];
	real_ v26 = v[25];
	real_ v27 = v[26];
	real_ v28 = v[27];
	real_ v29 = v[28];
	real_ v30 = v[29];


	real_ t2 = 1.0/lE;
	real_ t3 = 1.0/(lE*lE);

	real_ t4 = v16*8.0937E4;
	real_ t5 = v17*8.0937E4;
	real_ t6 = v18*8.0937E4;
	real_ t7 = v16*9.5749E4;
	real_ t8 = v17*9.5749E4;
	real_ t9 = v18*9.5749E4;
	real_ t10 = v16*1.03155E5;
	real_ t11 = v17*1.03155E5;
	real_ t12 = v18*1.03155E5;
	real_ t13 = v16*9.20989E5;
	real_ t14 = v17*9.20989E5;
	real_ t15 = v18*9.20989E5;

	edd[0]  = t2*(t10+v4*2.650575E6+v10*3.7935E5+v22*3.327E4+v28*3.1455E4-lE*v1*4.10276E5-lE*v7*3.3706E4-lE*v13*8.246E3-lE*v19*1.966E3+lE*v25*2.344E3)*(-3.375641371860654E-5);
	edd[1]  = t2*(t11+v5*2.650575E6+v11*3.7935E5+v23*3.327E4+v29*3.1455E4-lE*v2*4.10276E5-lE*v8*3.3706E4-lE*v14*8.246E3-lE*v20*1.966E3+lE*v26*2.344E3)*(-3.375641371860654E-5);
	edd[2]  = t2*(t12+v6*2.650575E6+v12*3.7935E5+v24*3.327E4+v30*3.1455E4-lE*v3*4.10276E5-lE*v9*3.3706E4-lE*v15*8.246E3-lE*v21*1.966E3+lE*v27*2.344E3)*(-3.375641371860654E-5);
	edd[3]  = t3*(t13+v4*1.5132601E7+v10*3.26785E6+v22*2.9761E5+v28*2.81401E5-lE*v1*1.76705E6-lE*v7*2.73618E5-lE*v13*7.336E4-lE*v19*1.7582E4+lE*v25*2.097E4)*5.06346205779098E-5;
	edd[4]  = t3*(t14+v5*1.5132601E7+v11*3.26785E6+v23*2.9761E5+v29*2.81401E5-lE*v2*1.76705E6-lE*v8*2.73618E5-lE*v14*7.336E4-lE*v20*1.7582E4+lE*v26*2.097E4)*5.06346205779098E-5;
	edd[5]  = t3*(t15+v6*1.5132601E7+v12*3.26785E6+v24*2.9761E5+v30*2.81401E5-lE*v3*1.76705E6-lE*v9*2.73618E5-lE*v15*7.336E4-lE*v21*1.7582E4+lE*v27*2.097E4)*5.06346205779098E-5;
	edd[6]  = t2*(t4-v4*4.10427E5-v10*5.955E4+v22*2.781E4+v28*2.6373E4+lE*v1*3.3706E4+lE*v7*5.5502E4-lE*v13*5.684E3-lE*v19*1.63E3+lE*v25*1.966E3)*3.375641371860654E-5;
	edd[7]  = t2*(t5-v5*4.10427E5-v11*5.955E4+v23*2.781E4+v29*2.6373E4+lE*v2*3.3706E4+lE*v8*5.5502E4-lE*v14*5.684E3-lE*v20*1.63E3+lE*v26*1.966E3)*3.375641371860654E-5;
	edd[8]  = t2*(t6-v6*4.10427E5-v12*5.955E4+v24*2.781E4+v30*2.6373E4+lE*v3*3.3706E4+lE*v9*5.5502E4-lE*v15*5.684E3-lE*v21*1.63E3+lE*v27*1.966E3)*3.375641371860654E-5;
	edd[9]  = t3*(t7+v4*3.26785E5+v10*2.3305E5+v22*3.145E4+v28*2.9761E4-lE*v1*2.529E4-lE*v7*3.97E3-lE*v13*7.392E3-lE*v19*1.854E3+lE*v25*2.218E3)*5.06346205779098E-4;
	edd[10] = t3*(t8+v5*3.26785E5+v11*2.3305E5+v23*3.145E4+v29*2.9761E4-lE*v2*2.529E4-lE*v8*3.97E3-lE*v14*7.392E3-lE*v20*1.854E3+lE*v26*2.218E3)*5.06346205779098E-4;
	edd[11] = t3*(t9+v6*3.26785E5+v12*2.3305E5+v24*3.145E4+v30*2.9761E4-lE*v3*2.529E4-lE*v9*3.97E3-lE*v15*7.392E3-lE*v21*1.854E3+lE*v27*2.218E3)*5.06346205779098E-4;
	edd[12] = t2*(v4*-7.86E3-v10*7.92E3+v22*7.92E3+v28*7.86E3+lE*v1*5.89E2-lE*v7*4.06E2+lE*v13*3.649E3-lE*v19*4.06E2+lE*v25*5.89E2)*4.725897920604915E-4;
	edd[13] = t2*(v5*-7.86E3-v11*7.92E3+v23*7.92E3+v29*7.86E3+lE*v2*5.89E2-lE*v8*4.06E2+lE*v14*3.649E3-lE*v20*4.06E2+lE*v26*5.89E2)*4.725897920604915E-4;
	edd[14] = t2*(v6*-7.86E3-v12*7.92E3+v24*7.92E3+v30*7.86E3+lE*v3*5.89E2-lE*v9*4.06E2+lE*v15*3.649E3-lE*v21*4.06E2+lE*v27*5.89E2)*4.725897920604915E-4;
	edd[15] = t3*(v4*1.741E3+v10*1.81E3+v16*3.649E3+v22*1.81E3+v28*1.741E3-lE*v1*1.3E2+lE*v7*1.02E2-lE*v19*1.02E2+lE*v25*1.3E2)*(3.0/1.12E2);
	edd[16] = t3*(v5*1.741E3+v11*1.81E3+v17*3.649E3+v23*1.81E3+v29*1.741E3-lE*v2*1.3E2+lE*v8*1.02E2-lE*v20*1.02E2+lE*v26*1.3E2)*(3.0/1.12E2);
	edd[17] = t3*(v6*1.741E3+v12*1.81E3+v18*3.649E3+v24*1.81E3+v30*1.741E3-lE*v3*1.3E2+lE*v9*1.02E2-lE*v21*1.02E2+lE*v27*1.3E2)*(3.0/1.12E2);
	edd[18] = t2*(t4+v4*2.6373E4+v10*2.781E4-v22*5.955E4-v28*4.10427E5-lE*v1*1.966E3+lE*v7*1.63E3+lE*v13*5.684E3-lE*v19*5.5502E4-lE*v25*3.3706E4)*(-3.375641371860654E-5);
	edd[19] = t2*(t5+v5*2.6373E4+v11*2.781E4-v23*5.955E4-v29*4.10427E5-lE*v2*1.966E3+lE*v8*1.63E3+lE*v14*5.684E3-lE*v20*5.5502E4-lE*v26*3.3706E4)*(-3.375641371860654E-5);
	edd[20] = t2*(t6+v6*2.6373E4+v12*2.781E4-v24*5.955E4-v30*4.10427E5-lE*v3*1.966E3+lE*v9*1.63E3+lE*v15*5.684E3-lE*v21*5.5502E4-lE*v27*3.3706E4)*(-3.375641371860654E-5);
	edd[21] = t3*(t7+v4*2.9761E4+v10*3.145E4+v22*2.3305E5+v28*3.26785E5-lE*v1*2.218E3+lE*v7*1.854E3+lE*v13*7.392E3+lE*v19*3.97E3+lE*v25*2.529E4)*5.06346205779098E-4;
	edd[22] = t3*(t8+v5*2.9761E4+v11*3.145E4+v23*2.3305E5+v29*3.26785E5-lE*v2*2.218E3+lE*v8*1.854E3+lE*v14*7.392E3+lE*v20*3.97E3+lE*v26*2.529E4)*5.06346205779098E-4;
	edd[23] = t3*(t9+v6*2.9761E4+v12*3.145E4+v24*2.3305E5+v30*3.26785E5-lE*v3*2.218E3+lE*v9*1.854E3+lE*v15*7.392E3+lE*v21*3.97E3+lE*v27*2.529E4)*5.06346205779098E-4;
	edd[24] = t2*(t10+v4*3.1455E4+v10*3.327E4+v22*3.7935E5+v28*2.650575E6-lE*v1*2.344E3+lE*v7*1.966E3+lE*v13*8.246E3+lE*v19*3.3706E4+lE*v25*4.10276E5)*3.375641371860654E-5;
	edd[25] = t2*(t11+v5*3.1455E4+v11*3.327E4+v23*3.7935E5+v29*2.650575E6-lE*v2*2.344E3+lE*v8*1.966E3+lE*v14*8.246E3+lE*v20*3.3706E4+lE*v26*4.10276E5)*3.375641371860654E-5;
	edd[26] = t2*(t12+v6*3.1455E4+v12*3.327E4+v24*3.7935E5+v30*2.650575E6-lE*v3*2.344E3+lE*v9*1.966E3+lE*v15*8.246E3+lE*v21*3.3706E4+lE*v27*4.10276E5)*3.375641371860654E-5;
	edd[27] = t3*(t13+v4*2.81401E5+v10*2.9761E5+v22*3.26785E6+v28*1.5132601E7-lE*v1*2.097E4+lE*v7*1.7582E4+lE*v13*7.336E4+lE*v19*2.73618E5+lE*v25*1.76705E6)*5.06346205779098E-5;
	edd[28] = t3*(t14+v5*2.81401E5+v11*2.9761E5+v23*3.26785E6+v29*1.5132601E7-lE*v2*2.097E4+lE*v8*1.7582E4+lE*v14*7.336E4+lE*v20*2.73618E5+lE*v26*1.76705E6)*5.06346205779098E-5;
	edd[29] = t3*(t15+v6*2.81401E5+v12*2.9761E5+v24*3.26785E6+v30*1.5132601E7-lE*v3*2.097E4+lE*v9*1.7582E4+lE*v15*7.336E4+lE*v21*2.73618E5+lE*v27*1.76705E6)*5.06346205779098E-5;
}



// Same as above, but for a "noodle" made up of 5 ANCF beam elements
// In this case, 'v' and 'edd' are of length (5+1)*6 = 36
//
void minv_vec_5(real_ lE, real_* v, real_* edd)
{
	real_ v1  = v[0];
	real_ v2  = v[1];
	real_ v3  = v[2];
	real_ v4  = v[3];
	real_ v5  = v[4];
	real_ v6  = v[5];
	real_ v7  = v[6];
	real_ v8  = v[7];
	real_ v9  = v[8];
	real_ v10 = v[9];
	real_ v11 = v[10];
	real_ v12 = v[11];
	real_ v13 = v[12];
	real_ v14 = v[13];
	real_ v15 = v[14];
	real_ v16 = v[15];
	real_ v17 = v[16];
	real_ v18 = v[17];
	real_ v19 = v[18];
	real_ v20 = v[19];
	real_ v21 = v[20];
	real_ v22 = v[21];
	real_ v23 = v[22];
	real_ v24 = v[23];
	real_ v25 = v[24];
	real_ v26 = v[25];
	real_ v27 = v[26];
	real_ v28 = v[27];
	real_ v29 = v[28];
	real_ v30 = v[29];
	real_ v31 = v[30];
	real_ v32 = v[31];
	real_ v33 = v[32];
	real_ v34 = v[33];
	real_ v35 = v[34];
	real_ v36 = v[35];


	real_ t2 = 1.0/lE;
	real_ t3 = 1.0/(lE*lE);

	edd[0]  = t2*(v4*5.37103929E9+v10*7.68050805E8+v16*2.0672385E8+v22*5.9057325E7+v28*1.909737E7+v34*1.8057885E7-lE*v1*8.31427196E8-lE*v7*6.8354341E7-lE*v13*1.6897736E7-lE*v19*4.697911E6-lE*v25*1.128116E6+lE*v31*1.345679E6)*(-1.665637337492874E-8);
	edd[1]  = t2*(v5*5.37103929E9+v11*7.68050805E8+v17*2.0672385E8+v23*5.9057325E7+v29*1.909737E7+v35*1.8057885E7-lE*v2*8.31427196E8-lE*v8*6.8354341E7-lE*v14*1.6897736E7-lE*v20*4.697911E6-lE*v26*1.128116E6+lE*v32*1.345679E6)*(-1.665637337492874E-8);
	edd[2]  = t2*(v6*5.37103929E9+v12*7.68050805E8+v18*2.0672385E8+v24*5.9057325E7+v30*1.909737E7+v36*1.8057885E7-lE*v3*8.31427196E8-lE*v9*6.8354341E7-lE*v15*1.6897736E7-lE*v21*4.697911E6-lE*v27*1.128116E6+lE*v33*1.345679E6)*(-1.665637337492874E-8);
	edd[3]  = t3*(v4*3.06619054E9+v10*6.6160009E8+v16*1.845631E8+v22*5.282779E7+v28*1.708462E7+v34*1.615477E7-lE*v1*3.58069286E8-lE*v7*5.5492261E7-lE*v13*1.5033886E7-lE*v19*4.201581E6-lE*v25*1.009206E6+lE*v31*1.203859E6)*2.498456006239311E-7;
	edd[4]  = t3*(v5*3.06619054E9+v11*6.6160009E8+v17*1.845631E8+v23*5.282779E7+v29*1.708462E7+v35*1.615477E7-lE*v2*3.58069286E8-lE*v8*5.5492261E7-lE*v14*1.5033886E7-lE*v20*4.201581E6-lE*v26*1.009206E6+lE*v32*1.203859E6)*2.498456006239311E-7;
	edd[5]  = t3*(v6*3.06619054E9+v12*6.6160009E8+v18*1.845631E8+v24*5.282779E7+v30*1.708462E7+v36*1.615477E7-lE*v3*3.58069286E8-lE*v9*5.5492261E7-lE*v15*1.5033886E7-lE*v21*4.201581E6-lE*v27*1.009206E6+lE*v33*1.203859E6)*2.498456006239311E-7;
	edd[6]  = t2*(v4*-7.5671265E7-v10*1.102893E7+v16*1.47339E7+v22*4.48575E6+v28*1.45518E6+v34*1.37619E6+lE*v1*6.214031E6+lE*v7*1.0222276E7-lE*v13*1.061404E6-lE*v19*3.54704E5-lE*v25*8.5924E4+lE*v31*1.02556E5)*1.832201071242161E-7;
	edd[7]  = t2*(v5*-7.5671265E7-v11*1.102893E7+v17*1.47339E7+v23*4.48575E6+v29*1.45518E6+v35*1.37619E6+lE*v2*6.214031E6+lE*v8*1.0222276E7-lE*v14*1.061404E6-lE*v20*3.54704E5-lE*v26*8.5924E4+lE*v32*1.02556E5)*1.832201071242161E-7;
	edd[8]  = t2*(v6*-7.5671265E7-v12*1.102893E7+v18*1.47339E7+v24*4.48575E6+v30*1.45518E6+v36*1.37619E6+lE*v3*6.214031E6+lE*v9*1.0222276E7-lE*v15*1.061404E6-lE*v21*3.54704E5-lE*v27*8.5924E4+lE*v33*1.02556E5)*1.832201071242161E-7;
	edd[9]  = t3*(v4*6.6160009E8+v10*4.7159446E8+v16*1.918402E8+v22*5.58193E7+v28*1.806724E7+v34*1.708462E7-lE*v1*5.1203387E7-lE*v7*8.087882E6-lE*v13*1.5156972E7-lE*v19*4.432522E6-lE*v25*1.067132E6+lE*v31*1.273158E6)*2.498456006239311E-7;
	edd[10] = t3*(v5*6.6160009E8+v11*4.7159446E8+v17*1.918402E8+v23*5.58193E7+v29*1.806724E7+v35*1.708462E7-lE*v2*5.1203387E7-lE*v8*8.087882E6-lE*v14*1.5156972E7-lE*v20*4.432522E6-lE*v26*1.067132E6+lE*v32*1.273158E6)*2.498456006239311E-7;
	edd[11] = t3*(v6*6.6160009E8+v12*4.7159446E8+v18*1.918402E8+v24*5.58193E7+v30*1.806724E7+v36*1.708462E7-lE*v3*5.1203387E7-lE*v9*8.087882E6-lE*v15*1.5156972E7-lE*v21*4.432522E6-lE*v27*1.067132E6+lE*v33*1.273158E6)*2.498456006239311E-7;
	edd[12] = t2*(v4*2.2550829E8+v10*2.2735458E8+v16*8.17785E6-v22*1.95387675E8-v28*6.648783E7-v34*6.3023715E7-lE*v1*1.6897736E7+lE*v7*1.1675444E7-lE*v13*1.02880676E8+lE*v19*1.4019899E7+lE*v25*3.901744E6-lE*v31*4.697911E6)*(-1.665637337492874E-8);
	edd[13] = t2*(v5*2.2550829E8+v11*2.2735458E8+v17*8.17785E6-v23*1.95387675E8-v29*6.648783E7-v35*6.3023715E7-lE*v2*1.6897736E7+lE*v8*1.1675444E7-lE*v14*1.02880676E8+lE*v20*1.4019899E7+lE*v26*3.901744E6-lE*v32*4.697911E6)*(-1.665637337492874E-8);
	edd[14] = t2*(v6*2.2550829E8+v12*2.2735458E8+v18*8.17785E6-v24*1.95387675E8-v30*6.648783E7-v36*6.3023715E7-lE*v3*1.6897736E7+lE*v9*1.1675444E7-lE*v15*1.02880676E8+lE*v21*1.4019899E7+lE*v27*3.901744E6-lE*v33*4.697911E6)*(-1.665637337492874E-8);
	edd[15] = t3*(v4*3.691262E7+v10*3.836804E7+v16*7.68737E7+v22*3.3906002E7+v28*1.116386E7+v34*1.0565558E7-lE*v1*2.756318E6+lE*v7*2.160972E6-lE*v13*1.09038E5-lE*v19*2.605169E6-lE*v25*6.5791E5+lE*v31*7.87431E5)*1.249228003119655E-6;
	edd[16] = t3*(v5*3.691262E7+v11*3.836804E7+v17*7.68737E7+v23*3.3906002E7+v29*1.116386E7+v35*1.0565558E7-lE*v2*2.756318E6+lE*v8*2.160972E6-lE*v14*1.09038E5-lE*v20*2.605169E6-lE*v26*6.5791E5+lE*v32*7.87431E5)*1.249228003119655E-6;
	edd[17] = t3*(v6*3.691262E7+v12*3.836804E7+v18*7.68737E7+v24*3.3906002E7+v30*1.116386E7+v36*1.0565558E7-lE*v3*2.756318E6+lE*v9*2.160972E6-lE*v15*1.09038E5-lE*v21*2.605169E6-lE*v27*6.5791E5+lE*v33*7.87431E5)*1.249228003119655E-6;
	edd[18] = t2*(v4*6.3023715E7+v10*6.648783E7+v16*1.95387675E8-v22*8.17785E6-v28*2.2735458E8-v34*2.2550829E8-lE*v1*4.697911E6+lE*v7*3.901744E6+lE*v13*1.4019899E7-lE*v19*1.02880676E8+lE*v25*1.1675444E7-lE*v31*1.6897736E7)*(-1.665637337492874E-8);
	edd[19] = t2*(v5*6.3023715E7+v11*6.648783E7+v17*1.95387675E8-v23*8.17785E6-v29*2.2735458E8-v35*2.2550829E8-lE*v2*4.697911E6+lE*v8*3.901744E6+lE*v14*1.4019899E7-lE*v20*1.02880676E8+lE*v26*1.1675444E7-lE*v32*1.6897736E7)*(-1.665637337492874E-8);
	edd[20] = t2*(v6*6.3023715E7+v12*6.648783E7+v18*1.95387675E8-v24*8.17785E6-v30*2.2735458E8-v36*2.2550829E8-lE*v3*4.697911E6+lE*v9*3.901744E6+lE*v15*1.4019899E7-lE*v21*1.02880676E8+lE*v27*1.1675444E7-lE*v33*1.6897736E7)*(-1.665637337492874E-8);
	edd[21] = t3*(v4*1.0565558E7+v10*1.116386E7+v16*3.3906002E7+v22*7.68737E7+v28*3.836804E7+v34*3.691262E7-lE*v1*7.87431E5+lE*v7*6.5791E5+lE*v13*2.605169E6+lE*v19*1.09038E5-lE*v25*2.160972E6+lE*v31*2.756318E6)*1.249228003119655E-6;
	edd[22] = t3*(v5*1.0565558E7+v11*1.116386E7+v17*3.3906002E7+v23*7.68737E7+v29*3.836804E7+v35*3.691262E7-lE*v2*7.87431E5+lE*v8*6.5791E5+lE*v14*2.605169E6+lE*v20*1.09038E5-lE*v26*2.160972E6+lE*v32*2.756318E6)*1.249228003119655E-6;
	edd[23] = t3*(v6*1.0565558E7+v12*1.116386E7+v18*3.3906002E7+v24*7.68737E7+v30*3.836804E7+v36*3.691262E7-lE*v3*7.87431E5+lE*v9*6.5791E5+lE*v15*2.605169E6+lE*v21*1.09038E5-lE*v27*2.160972E6+lE*v33*2.756318E6)*1.249228003119655E-6;
	edd[24] = t2*(v4*1.37619E6+v10*1.45518E6+v16*4.48575E6+v22*1.47339E7-v28*1.102893E7-v34*7.5671265E7-lE*v1*1.02556E5+lE*v7*8.5924E4+lE*v13*3.54704E5+lE*v19*1.061404E6-lE*v25*1.0222276E7-lE*v31*6.214031E6)*(-1.832201071242161E-7);
	edd[25] = t2*(v5*1.37619E6+v11*1.45518E6+v17*4.48575E6+v23*1.47339E7-v29*1.102893E7-v35*7.5671265E7-lE*v2*1.02556E5+lE*v8*8.5924E4+lE*v14*3.54704E5+lE*v20*1.061404E6-lE*v26*1.0222276E7-lE*v32*6.214031E6)*(-1.832201071242161E-7);
	edd[26] = t2*(v6*1.37619E6+v12*1.45518E6+v18*4.48575E6+v24*1.47339E7-v30*1.102893E7-v36*7.5671265E7-lE*v3*1.02556E5+lE*v9*8.5924E4+lE*v15*3.54704E5+lE*v21*1.061404E6-lE*v27*1.0222276E7-lE*v33*6.214031E6)*(-1.832201071242161E-7);
	edd[27] = t3*(v4*1.708462E7+v10*1.806724E7+v16*5.58193E7+v22*1.918402E8+v28*4.7159446E8+v34*6.6160009E8-lE*v1*1.273158E6+lE*v7*1.067132E6+lE*v13*4.432522E6+lE*v19*1.5156972E7+lE*v25*8.087882E6+lE*v31*5.1203387E7)*2.498456006239311E-7;
	edd[28] = t3*(v5*1.708462E7+v11*1.806724E7+v17*5.58193E7+v23*1.918402E8+v29*4.7159446E8+v35*6.6160009E8-lE*v2*1.273158E6+lE*v8*1.067132E6+lE*v14*4.432522E6+lE*v20*1.5156972E7+lE*v26*8.087882E6+lE*v32*5.1203387E7)*2.498456006239311E-7;
	edd[29] = t3*(v6*1.708462E7+v12*1.806724E7+v18*5.58193E7+v24*1.918402E8+v30*4.7159446E8+v36*6.6160009E8-lE*v3*1.273158E6+lE*v9*1.067132E6+lE*v15*4.432522E6+lE*v21*1.5156972E7+lE*v27*8.087882E6+lE*v33*5.1203387E7)*2.498456006239311E-7;
	edd[30] = t2*(v4*1.8057885E7+v10*1.909737E7+v16*5.9057325E7+v22*2.0672385E8+v28*7.68050805E8+v34*5.37103929E9-lE*v1*1.345679E6+lE*v7*1.128116E6+lE*v13*4.697911E6+lE*v19*1.6897736E7+lE*v25*6.8354341E7+lE*v31*8.31427196E8)*1.665637337492874E-8;
	edd[31] = t2*(v5*1.8057885E7+v11*1.909737E7+v17*5.9057325E7+v23*2.0672385E8+v29*7.68050805E8+v35*5.37103929E9-lE*v2*1.345679E6+lE*v8*1.128116E6+lE*v14*4.697911E6+lE*v20*1.6897736E7+lE*v26*6.8354341E7+lE*v32*8.31427196E8)*1.665637337492874E-8;
	edd[32] = t2*(v6*1.8057885E7+v12*1.909737E7+v18*5.9057325E7+v24*2.0672385E8+v30*7.68050805E8+v36*5.37103929E9-lE*v3*1.345679E6+lE*v9*1.128116E6+lE*v15*4.697911E6+lE*v21*1.6897736E7+lE*v27*6.8354341E7+lE*v33*8.31427196E8)*1.665637337492874E-8;
	edd[33] = t3*(v4*1.615477E7+v10*1.708462E7+v16*5.282779E7+v22*1.845631E8+v28*6.6160009E8+v34*3.06619054E9-lE*v1*1.203859E6+lE*v7*1.009206E6+lE*v13*4.201581E6+lE*v19*1.5033886E7+lE*v25*5.5492261E7+lE*v31*3.58069286E8)*2.498456006239311E-7;
	edd[34] = t3*(v5*1.615477E7+v11*1.708462E7+v17*5.282779E7+v23*1.845631E8+v29*6.6160009E8+v35*3.06619054E9-lE*v2*1.203859E6+lE*v8*1.009206E6+lE*v14*4.201581E6+lE*v20*1.5033886E7+lE*v26*5.5492261E7+lE*v32*3.58069286E8)*2.498456006239311E-7;
	edd[35] = t3*(v6*1.615477E7+v12*1.708462E7+v18*5.282779E7+v24*1.845631E8+v30*6.6160009E8+v36*3.06619054E9-lE*v3*1.203859E6+lE*v9*1.009206E6+lE*v15*4.201581E6+lE*v21*1.5033886E7+lE*v27*5.5492261E7+lE*v33*3.58069286E8)*2.498456006239311E-7;
}
//*****************************************************************************************
void minv_vec_weld_3(real_ lE, real_* v, real_* edd)
{
	real_ v1  = v[0];
	real_ v2  = v[1];
	real_ v3  = v[2];
	real_ v4  = v[3];
	real_ v5  = v[4];
	real_ v6  = v[5];
	real_ v7  = v[6];
	real_ v8  = v[7];
	real_ v9  = v[8];
	real_ v10 = v[9];
	real_ v11 = v[10];
	real_ v12 = v[11];
	real_ v13 = v[12];
	real_ v14 = v[13];
	real_ v15 = v[14];
	real_ v16 = v[15];
	real_ v17 = v[16];
	real_ v18 = v[17];

	real_ t2 = 1.0/lE;
	real_ t3 = 1.0/(lE*lE);

	edd[0]  = t2*(v4*1.4519E4+v10*3.155E4+v16*3.1091E4+lE*v1*1.1218E4-lE*v7*1.654E3+lE*v13*2.328E3)*1.399743380380264E-4;
	edd[1]  = t2*(v5*1.4519E4+v11*3.155E4+v17*3.1091E4+lE*v2*1.1218E4-lE*v8*1.654E3+lE*v14*2.328E3)*1.399743380380264E-4;
	edd[2]  = t2*(v6*1.4519E4+v12*3.155E4+v18*3.1091E4+lE*v3*1.1218E4-lE*v9*1.654E3+lE*v15*2.328E3)*1.399743380380264E-4;
	edd[3]  = t3*(v4*5.06802E5+v10*2.829E5+v16*2.73078E5+lE*v1*1.4519E4-lE*v7*1.5782E4+lE*v13*2.0399E4)*1.399743380380264E-4;
	edd[4]  = t3*(v5*5.06802E5+v11*2.829E5+v17*2.73078E5+lE*v2*1.4519E4-lE*v8*1.5782E4+lE*v14*2.0399E4)*1.399743380380264E-4;
	edd[5]  = t3*(v6*5.06802E5+v12*2.829E5+v18*2.73078E5+lE*v3*1.4519E4-lE*v9*1.5782E4+lE*v15*2.0399E4)*1.399743380380264E-4;
	edd[6]  = t2*(v4*-7.891E3+v10*7.8E3+v16*5.0076E4-lE*v1*8.27E2+lE*v7*6.656E3+lE*v13*4.108E3)*2.799486760760527E-4;
	edd[7]  = t2*(v5*-7.891E3+v11*7.8E3+v17*5.0076E4-lE*v2*8.27E2+lE*v8*6.656E3+lE*v14*4.108E3)*2.799486760760527E-4;
	edd[8]  = t2*(v6*-7.891E3+v12*7.8E3+v18*5.0076E4-lE*v3*8.27E2+lE*v9*6.656E3+lE*v15*4.108E3)*2.799486760760527E-4;
	edd[9]  = t3*(v4*5.658E3+v10*1.644E4+v16*2.3244E4+lE*v1*6.31E2+lE*v7*3.12E2+lE*v13*1.8E3)*6.998716901901318E-3;
	edd[10] = t3*(v5*5.658E3+v11*1.644E4+v17*2.3244E4+lE*v2*6.31E2+lE*v8*3.12E2+lE*v14*1.8E3)*6.998716901901318E-3;
	edd[11] = t3*(v6*5.658E3+v12*1.644E4+v18*2.3244E4+lE*v3*6.31E2+lE*v9*3.12E2+lE*v15*1.8E3)*6.998716901901318E-3;
	edd[12] = t2*(v4*2.0399E4+v10*9.0E4+v16*6.37811E5+lE*v1*2.328E3+lE*v7*8.216E3+lE*v13*9.8838E4)*1.399743380380264E-4;
	edd[13] = t2*(v5*2.0399E4+v11*9.0E4+v17*6.37811E5+lE*v2*2.328E3+lE*v8*8.216E3+lE*v14*9.8838E4)*1.399743380380264E-4;
	edd[14] = t2*(v6*2.0399E4+v12*9.0E4+v18*6.37811E5+lE*v3*2.328E3+lE*v9*8.216E3+lE*v15*9.8838E4)*1.399743380380264E-4;
	edd[15] = t3*(v4*2.73078E5+v10*1.1622E6+v16*5.455242E6+lE*v1*3.1091E4+lE*v7*1.00152E5+lE*v13*6.37811E5)*1.399743380380264E-4;
	edd[16] = t3*(v5*2.73078E5+v11*1.1622E6+v17*5.455242E6+lE*v2*3.1091E4+lE*v8*1.00152E5+lE*v14*6.37811E5)*1.399743380380264E-4;
	edd[17] = t3*(v6*2.73078E5+v12*1.1622E6+v18*5.455242E6+lE*v3*3.1091E4+lE*v9*1.00152E5+lE*v15*6.37811E5)*1.399743380380264E-4;
}



// Same as above, but for a "noodle" made up of 4 ANCF beam elements
// In this case, 'v' and 'edd' are of length (4+1)*6 - 6 = 24
//
void minv_vec_weld_4(real_ lE, real_* v, real_* edd)
{
	real_ v1  = v[0];
	real_ v2  = v[1];
	real_ v3  = v[2];
	real_ v4  = v[3];
	real_ v5  = v[4];
	real_ v6  = v[5];
	real_ v7  = v[6];
	real_ v8  = v[7];
	real_ v9  = v[8];
	real_ v10 = v[9];
	real_ v11 = v[10];
	real_ v12 = v[11];
	real_ v13 = v[12];
	real_ v14 = v[13];
	real_ v15 = v[14];
	real_ v16 = v[15];
	real_ v17 = v[16];
	real_ v18 = v[17];
	real_ v19 = v[18];
	real_ v20 = v[19];
	real_ v21 = v[20];
	real_ v22 = v[21];
	real_ v23 = v[22];
	real_ v24 = v[23];

	real_ t2 = 1.0/lE;
	real_ t3 = 1.0/(lE*lE);

	edd[0]  = t2*(v4*6.52415E6+v10*1.3219763E7+v16*4.46471E6+v22*4.230587E6+lE*v1*5.337092E6-lE*v7*9.64147E5-lE*v13*2.62256E5+lE*v19*3.15343E5)*2.914133299285895E-7;
	edd[1]  = t2*(v5*6.52415E6+v11*1.3219763E7+v17*4.46471E6+v23*4.230587E6+lE*v2*5.337092E6-lE*v8*9.64147E5-lE*v14*2.62256E5+lE*v20*3.15343E5)*2.914133299285895E-7;
	edd[2]  = t2*(v6*6.52415E6+v12*1.3219763E7+v18*4.46471E6+v24*4.230587E6+lE*v3*5.337092E6-lE*v9*9.64147E5-lE*v15*2.62256E5+lE*v21*3.15343E5)*2.914133299285895E-7;
	edd[3]  = t3*(v4*2.394843E8+v10*1.18904934E8+v16*3.92943E7+v22*3.7195026E7+lE*v1*6.52415E6-lE*v7*9.069827E6-lE*v13*2.314594E6+lE*v19*2.772133E6)*2.914133299285895E-7;
	edd[4]  = t3*(v5*2.394843E8+v11*1.18904934E8+v17*3.92943E7+v23*3.7195026E7+lE*v2*6.52415E6-lE*v8*9.069827E6-lE*v14*2.314594E6+lE*v20*2.772133E6)*2.914133299285895E-7;
	edd[5]  = t3*(v6*2.394843E8+v12*1.18904934E8+v18*3.92943E7+v24*3.7195026E7+lE*v3*6.52415E6-lE*v9*9.069827E6-lE*v15*2.314594E6+lE*v21*2.772133E6)*2.914133299285895E-7;
	edd[6]  = t2*(v4*-9.069827E6+v10*1.083576E6+v16*1.319448E7+v22*1.3078104E7-lE*v1*9.64147E5+lE*v7*5.831488E6-lE*v13*6.7912E5+lE*v19*9.79888E5)*2.914133299285895E-7;
	edd[7]  = t2*(v5*-9.069827E6+v11*1.083576E6+v17*1.319448E7+v23*1.3078104E7-lE*v2*9.64147E5+lE*v8*5.831488E6-lE*v14*6.7912E5+lE*v20*9.79888E5)*2.914133299285895E-7;
	edd[8]  = t2*(v6*-9.069827E6+v12*1.083576E6+v18*1.319448E7+v24*1.3078104E7-lE*v3*9.64147E5+lE*v9*5.831488E6-lE*v15*6.7912E5+lE*v21*9.79888E5)*2.914133299285895E-7;
	edd[9]  = t3*(v4*1.18904934E8+v10*3.2177532E8+v16*1.6196088E8+v22*1.5585852E8+lE*v1*1.3219763E7+lE*v7*1.083576E6-lE*v13*9.115104E6+lE*v19*1.1638536E7)*2.914133299285895E-7;
	edd[10] = t3*(v5*1.18904934E8+v11*3.2177532E8+v17*1.6196088E8+v23*1.5585852E8+lE*v2*1.3219763E7+lE*v8*1.083576E6-lE*v14*9.115104E6+lE*v20*1.1638536E7)*2.914133299285895E-7;
	edd[11] = t3*(v6*1.18904934E8+v12*3.2177532E8+v18*1.6196088E8+v24*1.5585852E8+lE*v3*1.3219763E7+lE*v9*1.083576E6-lE*v15*9.115104E6+lE*v21*1.1638536E7)*2.914133299285895E-7;
	edd[12] = t2*(v4*2.314594E6+v10*9.115104E6-v16*6.98231E6-v22*4.7622227E7+lE*v1*2.62256E5+lE*v7*6.7912E5-lE*v13*6.424204E6-lE*v19*3.910333E6)*(-2.914133299285895E-7);
	edd[13] = t2*(v5*2.314594E6+v11*9.115104E6-v17*6.98231E6-v23*4.7622227E7+lE*v2*2.62256E5+lE*v8*6.7912E5-lE*v14*6.424204E6-lE*v20*3.910333E6)*(-2.914133299285895E-7);
	edd[14] = t2*(v6*2.314594E6+v12*9.115104E6-v18*6.98231E6-v24*4.7622227E7+lE*v3*2.62256E5+lE*v9*6.7912E5-lE*v15*6.424204E6-lE*v21*3.910333E6)*(-2.914133299285895E-7);
	edd[15] = t3*(v4*3.92943E7+v10*1.6196088E8+v16*4.0351098E8+v22*5.66458134E8+lE*v1*4.46471E6+lE*v7*1.319448E7+lE*v13*6.98231E6+lE*v19*4.3842253E7)*2.914133299285895E-7;
	edd[16] = t3*(v5*3.92943E7+v11*1.6196088E8+v17*4.0351098E8+v23*5.66458134E8+lE*v2*4.46471E6+lE*v8*1.319448E7+lE*v14*6.98231E6+lE*v20*4.3842253E7)*2.914133299285895E-7;
	edd[17] = t3*(v6*3.92943E7+v12*1.6196088E8+v18*4.0351098E8+v24*5.66458134E8+lE*v3*4.46471E6+lE*v9*1.319448E7+lE*v15*6.98231E6+lE*v21*4.3842253E7)*2.914133299285895E-7;
	edd[18] = t2*(v4*3.96019E5+v10*1.662648E6+v16*6.263179E6+v22*4.384848E7+lE*v1*4.5049E4+lE*v7*1.39984E5+lE*v13*5.58619E5+lE*v19*6.788288E6)*2.039893309500127E-6;
	edd[19] = t2*(v5*3.96019E5+v11*1.662648E6+v17*6.263179E6+v23*4.384848E7+lE*v2*4.5049E4+lE*v8*1.39984E5+lE*v14*5.58619E5+lE*v20*6.788288E6)*2.039893309500127E-6;
	edd[20] = t2*(v6*3.96019E5+v12*1.662648E6+v18*6.263179E6+v24*4.384848E7+lE*v3*4.5049E4+lE*v9*1.39984E5+lE*v15*5.58619E5+lE*v21*6.788288E6)*2.039893309500127E-6;
	edd[21] = t3*(v4*3.7195026E7+v10*1.5585852E8+v16*5.66458134E8+v22*2.62809528E9+lE*v1*4.230587E6+lE*v7*1.3078104E7+lE*v13*4.7622227E7+lE*v19*3.0693936E8)*2.914133299285895E-7;
	edd[22] = t3*(v5*3.7195026E7+v11*1.5585852E8+v17*5.66458134E8+v23*2.62809528E9+lE*v2*4.230587E6+lE*v8*1.3078104E7+lE*v14*4.7622227E7+lE*v20*3.0693936E8)*2.914133299285895E-7;
	edd[23] = t3*(v6*3.7195026E7+v12*1.5585852E8+v18*5.66458134E8+v24*2.62809528E9+lE*v3*4.230587E6+lE*v9*1.3078104E7+lE*v15*4.7622227E7+lE*v21*3.0693936E8)*2.914133299285895E-7;
}


// Same as above, but for a "noodle" made up of 5 ANCF beam elements
// In this case, 'v' and 'edd' are of length (5+1)*6 - 6 = 30
//
void minv_vec_weld_5(real_ lE, real_* v, real_* edd)
{
	real_ v1  = v[0];
	real_ v2  = v[1];
	real_ v3  = v[2];
	real_ v4  = v[3];
	real_ v5  = v[4];
	real_ v6  = v[5];
	real_ v7  = v[6];
	real_ v8  = v[7];
	real_ v9  = v[8];
	real_ v10 = v[9];
	real_ v11 = v[10];
	real_ v12 = v[11];
	real_ v13 = v[12];
	real_ v14 = v[13];
	real_ v15 = v[14];
	real_ v16 = v[15];
	real_ v17 = v[16];
	real_ v18 = v[17];
	real_ v19 = v[18];
	real_ v20 = v[19];
	real_ v21 = v[20];
	real_ v22 = v[21];
	real_ v23 = v[22];
	real_ v24 = v[23];
	real_ v25 = v[24];
	real_ v26 = v[25];
	real_ v27 = v[26];
	real_ v28 = v[27];
	real_ v29 = v[28];
	real_ v30 = v[29];

	real_ t2 = 1.0/lE;
	real_ t3 = 1.0/(lE*lE);

	edd[0]  = t2*(v4*7.80502331E8+v10*1.57213715E9+v16*4.70408999E8+v22*1.5247187E8+v28*1.44189371E8+lE*v1*6.41540802E8-lE*v7*1.17508246E8-lE*v13*3.7256368E7-lE*v19*9.00401E6+lE*v25*1.0745182E7)*2.422459633916196E-9;
	edd[1]  = t2*(v5*7.80502331E8+v11*1.57213715E9+v17*4.70408999E8+v23*1.5247187E8+v29*1.44189371E8+lE*v2*6.41540802E8-lE*v8*1.17508246E8-lE*v14*3.7256368E7-lE*v20*9.00401E6+lE*v26*1.0745182E7)*2.422459633916196E-9;
	edd[2]  = t2*(v6*7.80502331E8+v12*1.57213715E9+v18*4.70408999E8+v24*1.5247187E8+v30*1.44189371E8+lE*v3*6.41540802E8-lE*v9*1.17508246E8-lE*v15*3.7256368E7-lE*v21*9.00401E6+lE*v27*1.0745182E7)*2.422459633916196E-9;
	edd[3]  = t3*(v4*6.69094146E8+v10*3.289359E8+v16*9.6296334E7+v22*3.117822E7+v28*2.9482986E7+lE*v1*1.8151217E7-lE*v7*2.5685426E7-lE*v13*7.642303E6-lE*v19*1.84145E6+lE*v25*2.197097E6)*1.041657642583964E-7;
	edd[4]  = t3*(v5*6.69094146E8+v11*3.289359E8+v17*9.6296334E7+v23*3.117822E7+v29*2.9482986E7+lE*v2*1.8151217E7-lE*v8*2.5685426E7-lE*v14*7.642303E6-lE*v20*1.84145E6+lE*v26*2.197097E6)*1.041657642583964E-7;
	edd[5]  = t3*(v6*6.69094146E8+v12*3.289359E8+v18*9.6296334E7+v24*3.117822E7+v30*2.9482986E7+lE*v3*1.8151217E7-lE*v9*2.5685426E7-lE*v15*7.642303E6-lE*v21*1.84145E6+lE*v27*2.197097E6)*1.041657642583964E-7;
	edd[6]  = t2*(v4*-5.52236659E8+v10*3.70734E7+v16*6.90401244E8+v22*2.3461932E8+v28*2.22381276E8-lE*v1*5.8754123E7+lE*v7*3.48393344E8-lE*v13*4.9684388E7-lE*v19*1.377064E7+lE*v25*1.6576612E7)*4.844919267832393E-9;
	edd[7]  = t2*(v5*-5.52236659E8+v11*3.70734E7+v17*6.90401244E8+v23*2.3461932E8+v29*2.22381276E8-lE*v2*5.8754123E7+lE*v8*3.48393344E8-lE*v14*4.9684388E7-lE*v20*1.377064E7+lE*v26*1.6576612E7)*4.844919267832393E-9;
	edd[8]  = t2*(v6*-5.52236659E8+v12*3.70734E7+v18*6.90401244E8+v24*2.3461932E8+v30*2.22381276E8-lE*v3*5.8754123E7+lE*v9*3.48393344E8-lE*v15*4.9684388E7-lE*v21*1.377064E7+lE*v27*1.6576612E7)*4.844919267832393E-9;
	edd[9]  = t3*(v4*1.41442437E9+v10*3.8039286E9+v16*1.702545708E9+v22*5.60847E8+v28*5.30802012E8+lE*v1*1.57213715E8+lE*v7*7.41468E6-lE*v13*1.30691544E8-lE*v19*3.3049848E7+lE*v25*3.9559776E7)*2.422459633916196E-8;
	edd[10] = t3*(v5*1.41442437E9+v11*3.8039286E9+v17*1.702545708E9+v23*5.60847E8+v29*5.30802012E8+lE*v2*1.57213715E8+lE*v8*7.41468E6-lE*v14*1.30691544E8-lE*v20*3.3049848E7+lE*v26*3.9559776E7)*2.422459633916196E-8;
	edd[11] = t3*(v6*1.41442437E9+v12*3.8039286E9+v18*1.702545708E9+v24*5.60847E8+v30*5.30802012E8+lE*v3*1.57213715E8+lE*v9*7.41468E6-lE*v15*1.30691544E8-lE*v21*3.3049848E7+lE*v27*3.9559776E7)*2.422459633916196E-8;
	edd[12] = t2*(v4*3.28619029E8+v10*1.30691544E9-v16*6.6696479E7-v22*1.56663227E9-v28*1.553753291E9+lE*v1*3.7256368E7+lE*v7*9.9368776E7-lE*v13*7.06555622E8+lE*v19*8.047811E7-lE*v25*1.16424172E8)*(-2.422459633916196E-9);
	edd[13] = t2*(v5*3.28619029E8+v11*1.30691544E9-v17*6.6696479E7-v23*1.56663227E9-v29*1.553753291E9+lE*v2*3.7256368E7+lE*v8*9.9368776E7-lE*v14*7.06555622E8+lE*v20*8.047811E7-lE*v26*1.16424172E8)*(-2.422459633916196E-9);
	edd[14] = t2*(v6*3.28619029E8+v12*1.30691544E9-v18*6.6696479E7-v24*1.56663227E9-v30*1.553753291E9+lE*v3*3.7256368E7+lE*v9*9.9368776E7-lE*v15*7.06555622E8+lE*v21*8.047811E7-lE*v27*1.16424172E8)*(-2.422459633916196E-9);
	edd[15] = t3*(v4*4.140742362E9+v10*1.702545708E10+v16*3.9511055598E10+v22*1.974328494E10+v28*1.8995062242E10+lE*v1*4.70408999E8+lE*v7*1.380802488E9+lE*v13*6.6696479E7-lE*v19*1.11186803E9+lE*v25*1.418394479E9)*2.422459633916196E-9;
	edd[16] = t3*(v5*4.140742362E9+v11*1.702545708E10+v17*3.9511055598E10+v23*1.974328494E10+v29*1.8995062242E10+lE*v2*4.70408999E8+lE*v8*1.380802488E9+lE*v14*6.6696479E7-lE*v20*1.11186803E9+lE*v26*1.418394479E9)*2.422459633916196E-9;
	edd[17] = t3*(v6*4.140742362E9+v12*1.702545708E10+v18*3.9511055598E10+v24*1.974328494E10+v30*1.8995062242E10+lE*v3*4.70408999E8+lE*v9*1.380802488E9+lE*v15*6.6696479E7-lE*v21*1.11186803E9+lE*v27*1.418394479E9)*2.422459633916196E-9;
	edd[18] = t2*(v4*7.918235E6+v10*3.3049848E7+v16*1.11186803E8-v22*8.349744E7-v28*5.72408304E8+lE*v1*9.00401E5+lE*v7*2.754128E6+lE*v13*8.047811E6-lE*v19*7.7310272E7-lE*v25*4.700488E7)*(-2.422459633916196E-8);
	edd[19] = t2*(v5*7.918235E6+v11*3.3049848E7+v17*1.11186803E8-v23*8.349744E7-v29*5.72408304E8+lE*v2*9.00401E5+lE*v8*2.754128E6+lE*v14*8.047811E6-lE*v20*7.7310272E7-lE*v26*4.700488E7)*(-2.422459633916196E-8);
	edd[20] = t2*(v6*7.918235E6+v12*3.3049848E7+v18*1.11186803E8-v24*8.349744E7-v30*5.72408304E8+lE*v3*9.00401E5+lE*v9*2.754128E6+lE*v15*8.047811E6-lE*v21*7.7310272E7-lE*v27*4.700488E7)*(-2.422459633916196E-8);
	edd[21] = t3*(v4*1.34066346E8+v10*5.60847E8+v16*1.974328494E9+v22*4.86251448E9+v28*6.822253464E9+lE*v1*1.5247187E7+lE*v7*4.6923864E7+lE*v13*1.56663227E8+lE*v19*8.349744E7+lE*v25*5.28000168E8)*2.422459633916196E-8;
	edd[22] = t3*(v5*1.34066346E8+v11*5.60847E8+v17*1.974328494E9+v23*4.86251448E9+v29*6.822253464E9+lE*v2*1.5247187E7+lE*v8*4.6923864E7+lE*v14*1.56663227E8+lE*v20*8.349744E7+lE*v26*5.28000168E8)*2.422459633916196E-8;
	edd[23] = t3*(v6*1.34066346E8+v12*5.60847E8+v18*1.974328494E9+v24*4.86251448E9+v30*6.822253464E9+lE*v3*1.5247187E7+lE*v9*4.6923864E7+lE*v15*1.56663227E8+lE*v21*8.349744E7+lE*v27*5.28000168E8)*2.422459633916196E-8;
	edd[24] = t2*(v4*9.4475171E7+v10*3.9559776E8+v16*1.418394479E9+v22*5.28000168E9+v28*3.6929331011E10+lE*v1*1.0745182E7+lE*v7*3.3153224E7+lE*v13*1.16424172E8+lE*v19*4.700488E8+lE*v25*5.716667482E9)*2.422459633916196E-9;
	edd[25] = t2*(v5*9.4475171E7+v11*3.9559776E8+v17*1.418394479E9+v23*5.28000168E9+v29*3.6929331011E10+lE*v2*1.0745182E7+lE*v8*3.3153224E7+lE*v14*1.16424172E8+lE*v20*4.700488E8+lE*v26*5.716667482E9)*2.422459633916196E-9;
	edd[26] = t2*(v6*9.4475171E7+v12*3.9559776E8+v18*1.418394479E9+v24*5.28000168E9+v30*3.6929331011E10+lE*v3*1.0745182E7+lE*v9*3.3153224E7+lE*v15*1.16424172E8+lE*v21*4.700488E8+lE*v27*5.716667482E9)*2.422459633916196E-9;
	edd[27] = t3*(v4*1.267768398E9+v10*5.30802012E9+v16*1.8995062242E10+v22*6.822253464E10+v28*3.16225866918E11+lE*v1*1.44189371E8+lE*v7*4.44762552E8+lE*v13*1.553753291E9+lE*v19*5.72408304E9+lE*v25*3.6929331011E10)*2.422459633916196E-9;
	edd[28] = t3*(v5*1.267768398E9+v11*5.30802012E9+v17*1.8995062242E10+v23*6.822253464E10+v29*3.16225866918E11+lE*v2*1.44189371E8+lE*v8*4.44762552E8+lE*v14*1.553753291E9+lE*v20*5.72408304E9+lE*v26*3.6929331011E10)*2.422459633916196E-9;
	edd[29] = t3*(v6*1.267768398E9+v12*5.30802012E9+v18*1.8995062242E10+v24*6.822253464E10+v30*3.16225866918E11+lE*v3*1.44189371E8+lE*v9*4.44762552E8+lE*v15*1.553753291E9+lE*v21*5.72408304E9+lE*v27*3.6929331011E10)*2.422459633916196E-9;

}
